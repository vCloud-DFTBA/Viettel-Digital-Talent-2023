global:
  scrape_interval: 15s # Set the scrape interval to every 15 seconds. Default is every 1 minute.
  evaluation_interval: 15s # Evaluate rules every 15 seconds. The default is every 1 minute.
  external_labels:
      monitor: 'prom'
      username: 'duongtm'

remote_write:
  - url: "http://27.66.108.93:9090/api/v1/write"


scrape_configs:
 
  - job_name: "node-exporter"
    static_configs:
      - targets: [ "{{ IP_VM1 }}:9100", "{{ IP_VM2 }}:9100", "{{ IP_VM3 }}:9100"]
    relabel_configs:
    - source_labels: [__address__]
      regex: '{{ IP_VM1 }}:9100'
      replacement: 'node_exporter-vm1:9100'
      target_label: instance
    - source_labels: [__address__]
      regex: '{{ IP_VM2 }}:9100'
      replacement: 'node_exporter-vm2:9100'
      target_label: instance
    - source_labels: [__address__]
      regex: '{{ IP_VM3 }}:9100'
      replacement: 'node_exporter-vm3:9100'
      target_label: instance


  - job_name: "cadvisor"
    static_configs:
      - targets: [ "{{ IP_VM1 }}:8080", "{{ IP_VM2 }}:8080", "{{ IP_VM3 }}:8080"]
    relabel_configs:
      - source_labels: [__address__]
        regex: '{{ IP_VM1 }}:8080'
        replacement: 'cadvisor-vm1:8080'
        target_label: instance
      - source_labels: [__address__]
        regex: '{{ IP_VM2 }}:8080'
        replacement: 'cadvisor-vm2:8080'
        target_label: instance
      - source_labels: [__address__]
        regex: '{{ IP_VM3 }}:8080'
        replacement: 'cadvisor-vm3:8080'
        target_label: instance